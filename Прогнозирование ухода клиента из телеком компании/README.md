# Описание проекта

## Цель
Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Необходимо построить такую модель. Результаты будут использоваться оператором для принятия мер, предотвращающих уход клиента. Например, предложение промокодов и специальных условий. Оценивать качество модели необходимо на кросс-валидации. Целевое значение метрики ROC-AUC - не ниже 0.85
  
## Используемые инструменты
pandas, matplotlib, seaborn, numpy, phik, sklearn, catboost
  
## Вывод
В процессе выполнения проекта все пункты плана были выполнены. Возникли трудности с преодолением порогового значения целевой метрики. Мы преодолели это с помощью создания нового признака - количества дней, на протяжение которых абонент являлся клиентом компании на основе двух столбцов: дат начала и окончания контракта (при пропуске для расчета использовалась дата загрузки таблицы - 1 февраля 2020 года). Также, для линейных моделей было проблемой наличие мультиколлинеарных признаков, что мы преодолели следующим образом:
- Мы удалили столбец с суммарными расходами клиентов
- Вместо всех столбцов, связанных с интернет - услугами, мы использовали в расчетах столбец со значениями - индикаторами (использует ли клиент интернет или нет). Это помогло избежать дублирования информации  
  
В проекте мы анализировали следующие модели:
- Логистическая регрессия
- Дерево решений
- Лес решения
- Градиентный бустинг CatBoost
  
Лучший результат показала модель CatBoost на 500 итерациях с глубиной дерева равной 3 и шагом в сторону градиента равным 0.3. Значение метрики ROC-AUC на кросс-валидации - примерно 0.91, на тестовой выборке - около 0.92. Так как ROC-AUC на тестовой выборке выше, чем на кросс-валидации, отсутствует переобучение модели. Основываясь на матрицу ошибок, модель верно предсказывает уход клиента примерно в 77.8% случаях.  
  
Как было упомянуто ранее, в процессе подготовки признаков к обучению модели мы удалили столбцы, связанные с интернет-услугами и с суммарными затратами клиента. Также, мы не использовали столбцы с уникальным идентификационным номером клиента, датами начала/окончания контракта с компанией и полом клиента. Следовательно, были задействованы следующие признаки:
- Количество дней, на протяжение которых абонент был клиентом
- Тип оплаты (раз в год/два раза в год/ежемесячно)
- Электронный расчетный лист
- Тип платежа
- Расходы клиента в месяц
- Является ли абонент пенсионером
- Есть ли у клиента муж/жена
- Наличие у абонента детей
- Пользование интернет - услугами
- Подключение телефона абонента к нескольким линиям одновремено
   
В процессе предобработки данных пропуски в столбце про подключение к нескольким линиям одновременно мы обнаружили довольно много пропусков. Они были заменены на значение 'No'. Значения столбцов с количеством дней и месячными расходами клиента были привелены к нормальному стандартному распределению. Для остальных столбцов с категориальными признаками мы использовали кодирование: для линейных моделей - One Hot Encoder, для 'деревянных' - Ordinal Encoder, а для градиентного бустинга были переданы незакодированные признаки.  
  
Наиболее важными из упомянутых признаков для предсказания ухода клиента оказались:
- Количество дней, на протяжение которых абонент был клиентом
- Размер месячного платежа клиента
- Тип оплаты
   
Так как было пройдено пороговое значение целевой метрики, цель проекта выполнена, и модель может быть представлена заказчику.

## Статус проекта
Завершен
